---
id: working-with-email-messages
url: assembly/net/working-with-email-messages
title: Working with Email Messages
weight: 4
description: ""
keywords: 
productName: GroupDocs.Assembly for .NET
hideChildren: False
---
<table class="sectionMacro" border="0" cellpadding="5" cellspacing="0" width="100%"><tbody><tr><td valign="top" width="50%"><div class="panel" style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px;"><div class="panelHeader" style="border-bottom-width: 1px; background-color: rgb(176, 196, 222);"><b>Contents Summary</b></div><div class="panelContent"><style type="text/css">div.rbtoc1593026666728 { padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; }div.rbtoc1593026666728 ul { list-style-type: none; list-style-image: none; margin-left: 0px; }div.rbtoc1593026666728 li { margin-left: 0px; padding-left: 0px; }</style><div class="toc rbtoc1593026666728"><ul class="toc-indentation"><li><span class="TOCOutline">1</span> <a href="#WorkingwithEmailMessages-WorkingwithEmailMessages">Working with Email Messages</a><ul class="toc-indentation"><li><span class="TOCOutline">1.1</span> <a href="#WorkingwithEmailMessages-WorkingwithTable-RowConditionalBlocks">Working with Table-Row Conditional Blocks</a></li><li><span class="TOCOutline">1.2</span> <a href="#WorkingwithEmailMessages-Download">Download</a><ul class="toc-indentation"><li><span class="TOCOutline">1.2.1</span> <a href="#WorkingwithEmailMessages-DataSourceDocument">Data Source Document</a></li><li><span class="TOCOutline">1.2.2</span> <a href="#WorkingwithEmailMessages-Template">Template</a></li></ul></li><li><span class="TOCOutline">1.3</span> <a href="#WorkingwithEmailMessages-TheCode">The Code</a></li></ul></li></ul></div></div></div></td><td valign="top" width="15%">&nbsp;</td><td valign="top" width="35%">&nbsp;</td></tr></tbody></table>

{{< alert style="info" >}}This feature is supported by version 18.2 or greater.{{< /alert >}}{{< alert style="info" >}}The code uses some of the objects defined in The Business Layer.{{< /alert >}}

## Working with Email Messages

GroupDocs.Assembly allows you to use data bands in table rows in **Email Messages**with HTML and RTF bodies. A table-row data band is a data band which body occupies single or multiple rows of a single document table. The body of such a band starts at the beginning of the first occupied row and ends at the end of the last occupied row as follows. The syntax for using data bands in email messages is as follows:

<table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p><strong>Client</strong></p></td><td class="confluenceTd"><p><strong>Manager</strong></p></td><td class="confluenceTd"><p><strong>Contract Price</strong></p></td></tr><tr><td class="confluenceTd"><p><strong>&lt;&lt;foreach [</strong></p><p><strong>&nbsp;&nbsp;&nbsp; c in ds</strong></p><p><strong>]&gt;&gt;&lt;&lt;[c.Client]&gt;&gt;</strong></p></td><td class="confluenceTd"><p><strong>&lt;&lt;[c.Manager]&gt;&gt;</strong></p></td><td class="confluenceTd"><p><strong>&lt;&lt;[c.Price]&gt;&gt;&lt;&lt;/</strong></p><p><strong>foreach&gt;&gt;</strong></p></td></tr></tbody></table>

### Working with Table-Row Conditional Blocks

You can also use a table-row conditional block which body occupies single or multiple rows of a single document table. The body of such a block (as well as the body of its every template option) starts at the beginning of the first occupied row and ends at the end of the last occupied row as follows:

<table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p><strong>&nbsp;</strong></p></td><td class="confluenceTd"><p><strong>&nbsp;</strong></p></td><td class="confluenceTd"><p><strong>&nbsp;</strong></p></td></tr><tr><td class="confluenceTd"><p><strong>&lt;&lt;if ...&gt;&gt; ...</strong></p></td><td class="confluenceTd"><p><strong>...</strong></p></td><td class="confluenceTd"><p><strong>...</strong></p></td></tr><tr><td class="confluenceTd"><p><strong>...</strong></p></td><td class="confluenceTd"><p><strong>...</strong></p></td><td class="confluenceTd"><p><strong>...</strong></p></td></tr><tr><td class="confluenceTd"><p><strong>&lt;&lt;elseif ...&gt;&gt; ...</strong></p></td><td class="confluenceTd"><p><strong>...</strong></p></td><td class="confluenceTd"><p><strong>...</strong></p></td></tr><tr><td class="confluenceTd"><p><strong>...</strong></p></td><td class="confluenceTd"><p><strong>...</strong></p></td><td class="confluenceTd"><p><strong>...</strong></p></td></tr><tr><td class="confluenceTd"><p><strong>&lt;&lt;else&gt;&gt; ...</strong></p></td><td class="confluenceTd"><p><strong>...</strong></p></td><td class="confluenceTd"><p><strong>...</strong></p></td></tr><tr><td class="confluenceTd"><p><strong>...</strong></p></td><td class="confluenceTd"><p><strong>...</strong></p></td><td class="confluenceTd"><p><strong>...</strong></p></td></tr><tr><td class="confluenceTd"><p><strong>...</strong></p></td><td class="confluenceTd"><p><strong>...</strong></p></td><td class="confluenceTd"><p><strong>... &lt;&lt;/if&gt;&gt;</strong></p></td></tr><tr><td class="confluenceTd"><p><strong>&nbsp;</strong></p></td><td class="confluenceTd"><p><strong>&nbsp;</strong></p></td><td class="confluenceTd"><p><strong>&nbsp;</strong></p><div><strong><br></strong></div></td></tr></tbody></table>

### Download

#### Data Source Document

*   [Managers Data.xlsx](https://github.com/groupdocs-assembly/GroupDocs.Assembly-for-.NET/blob/master/Examples/Data/Data%20Sources/Excel%20DataSource/Contracts%20Data.xlsx)

#### Template

*   [Working with Table Row Data Bands.msg](https://github.com/groupdocs-assembly/GroupDocs.Assembly-for-.NET/blob/master/Examples/Data/Source/Presentation%20Templates/Working%20With%20Table%20Row%20Data%20Bands.pptx)

### The Code

<table class="highlight tab-size js-file-line-container" data-tab-size="8" data-paste-markdown-skip=""><tbody><tr><td id="file-workingwithtablerowdatabandsemail-cs-L1" class="blob-num js-line-number" data-line-number="1"></td><td id="file-workingwithtablerowdatabandsemail-cs-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">//</span> For complete examples and data files, please go to https://github.com/groupdocsassembly/GroupDocs_Assembly_NET</span></td></tr><tr><td id="file-workingwithtablerowdatabandsemail-cs-L2" class="blob-num js-line-number" data-line-number="2"></td><td id="file-workingwithtablerowdatabandsemail-cs-LC2" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">//</span>Setting up source</span></td></tr><tr><td id="file-workingwithtablerowdatabandsemail-cs-L3" class="blob-num js-line-number" data-line-number="3"></td><td id="file-workingwithtablerowdatabandsemail-cs-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-k">string</span> <span class="pl-smi">strDocumentTemplate</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Email Templates/Working With Table Row Data Bands.msg<span class="pl-pds">"</span></span>;</td></tr><tr><td id="file-workingwithtablerowdatabandsemail-cs-L4" class="blob-num js-line-number" data-line-number="4"></td><td id="file-workingwithtablerowdatabandsemail-cs-LC4" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">//</span>Setting up destination</span></td></tr><tr><td id="file-workingwithtablerowdatabandsemail-cs-L5" class="blob-num js-line-number" data-line-number="5"></td><td id="file-workingwithtablerowdatabandsemail-cs-LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-k">string</span> <span class="pl-smi">strDocumentReport</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Email Reports/Working With Table Row Data Bands.msg<span class="pl-pds">"</span></span>;</td></tr><tr><td id="file-workingwithtablerowdatabandsemail-cs-L6" class="blob-num js-line-number" data-line-number="6"></td><td id="file-workingwithtablerowdatabandsemail-cs-LC6" class="blob-code blob-code-inner js-file-line"><span class="pl-k">try</span></td></tr><tr><td id="file-workingwithtablerowdatabandsemail-cs-L7" class="blob-num js-line-number" data-line-number="7"></td><td id="file-workingwithtablerowdatabandsemail-cs-LC7" class="blob-code blob-code-inner js-file-line">{</td></tr><tr><td id="file-workingwithtablerowdatabandsemail-cs-L8" class="blob-num js-line-number" data-line-number="8"></td><td id="file-workingwithtablerowdatabandsemail-cs-LC8" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">//</span> Assemble a document using the external document table as a data source.</span></td></tr><tr><td id="file-workingwithtablerowdatabandsemail-cs-L9" class="blob-num js-line-number" data-line-number="9"></td><td id="file-workingwithtablerowdatabandsemail-cs-LC9" class="blob-code blob-code-inner js-file-line"><span class="pl-en">DocumentAssembler</span> <span class="pl-smi">assembler</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">DocumentAssembler</span>();</td></tr><tr><td id="file-workingwithtablerowdatabandsemail-cs-L10" class="blob-num js-line-number" data-line-number="10"></td><td id="file-workingwithtablerowdatabandsemail-cs-LC10" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">assembler</span>.<span class="pl-en">AssembleDocument</span>(<span class="pl-smi">CommonUtilities</span>.<span class="pl-en">GetSourceDocument</span>(<span class="pl-smi">strDocumentTemplate</span>),</td></tr><tr><td id="file-workingwithtablerowdatabandsemail-cs-L11" class="blob-num js-line-number" data-line-number="11"></td><td id="file-workingwithtablerowdatabandsemail-cs-LC11" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">CommonUtilities</span>.<span class="pl-en">SetDestinationDocument</span>(<span class="pl-smi">strDocumentReport</span>),</td></tr><tr><td id="file-workingwithtablerowdatabandsemail-cs-L12" class="blob-num js-line-number" data-line-number="12"></td><td id="file-workingwithtablerowdatabandsemail-cs-LC12" class="blob-code blob-code-inner js-file-line"><span class="pl-k">new</span> <span class="pl-en">DataSourceInfo</span>(<span class="pl-smi">DataLayer</span>.<span class="pl-en">ExcelData</span>(), <span class="pl-s"><span class="pl-pds">"</span>ds<span class="pl-pds">"</span></span>));</td></tr><tr><td id="file-workingwithtablerowdatabandsemail-cs-L13" class="blob-num js-line-number" data-line-number="13"></td><td id="file-workingwithtablerowdatabandsemail-cs-LC13" class="blob-code blob-code-inner js-file-line"></td></tr><tr><td id="file-workingwithtablerowdatabandsemail-cs-L14" class="blob-num js-line-number" data-line-number="14"></td><td id="file-workingwithtablerowdatabandsemail-cs-LC14" class="blob-code blob-code-inner js-file-line">}</td></tr><tr><td id="file-workingwithtablerowdatabandsemail-cs-L15" class="blob-num js-line-number" data-line-number="15"></td><td id="file-workingwithtablerowdatabandsemail-cs-LC15" class="blob-code blob-code-inner js-file-line"><span class="pl-k">catch</span> (<span class="pl-en">Exception</span> <span class="pl-smi">ex</span>)</td></tr><tr><td id="file-workingwithtablerowdatabandsemail-cs-L16" class="blob-num js-line-number" data-line-number="16"></td><td id="file-workingwithtablerowdatabandsemail-cs-LC16" class="blob-code blob-code-inner js-file-line">{</td></tr><tr><td id="file-workingwithtablerowdatabandsemail-cs-L17" class="blob-num js-line-number" data-line-number="17"></td><td id="file-workingwithtablerowdatabandsemail-cs-LC17" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">Console</span>.<span class="pl-en">WriteLine</span>(<span class="pl-smi">ex</span>.<span class="pl-smi">Message</span>);</td></tr><tr><td id="file-workingwithtablerowdatabandsemail-cs-L18" class="blob-num js-line-number" data-line-number="18"></td><td id="file-workingwithtablerowdatabandsemail-cs-LC18" class="blob-code blob-code-inner js-file-line">}</td></tr></tbody></table>

[view raw](https://gist.github.com/GroupDocsGists/01bfbc9025752c94f28e24a28c3cd6ad/raw/97728c25c950616b1e6f445b6e31587516a5a7b1/WorkingWithTableRowDataBandsEmail.cs) [WorkingWithTableRowDataBandsEmail.cs](https://gist.github.com/GroupDocsGists/01bfbc9025752c94f28e24a28c3cd6ad#file-workingwithtablerowdatabandsemail-cs) hosted with ❤ by [GitHub](https://github.com)
